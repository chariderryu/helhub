# **HEL Hub 自動化システム 説明書**

このシステムは、堀田隆一氏の英語史活動（hel活）のポータルサイト「The HEL Hub」の運用を自動化・効率化するためのツール群です。RSSフィードからのコンテンツ自動取得、ウェブサイトの更新、X（旧Twitter）への予約投稿、メールマガジン原稿の生成などを一元管理できます。

## **主な機能**

* **ウェブサイト自動更新**: 複数のメディアのRSSフィードを巡回し、ウェブサイトのコンテンツを自動で更新します。  
* **X（旧Twitter）への自動投稿**: 取得したコンテンツを元に、テンプレートに基づいた投稿の下書きを自動生成。対話形式で内容を編集・承認し、指定した日時に予約投稿できます。  
* **高度な投稿フィルタリング**: 正規表現を利用して、コンテンツのタイトルに基づいて投稿するか否かを柔軟に制御できます。  
* **メールマガジン原稿生成**: 指定した期間の最新コンテンツをまとめた、メルマガ用の原稿を自動で作成します。  
* **安全な認証情報管理**: サーバーのパスワードやAPIキーなどの機密情報を.envファイルで安全に管理します。  
* **統合コマンドラインツール**: すべての機能をhelhub.pyという単一のコマンドから呼び出せます。

## **セットアップ手順**

### **ステップ1: Pythonの準備**

このシステムはPythonで動作します。PCにPythonがインストールされていない場合は、公式サイトから最新版をインストールしてください。

### **ステップ2: 必要なライブラリのインストール**

requirements.txtファイルがあることを確認し、ターミナル（コマンドプロンプト）で以下のコマンドを実行して、必要なライブラリをすべてインストールします。

pip install \-r requirements.txt

### **ステップ3: 設定ファイルの準備**

1. **.env.exampleをコピー**: .env.exampleファイルをコピーし、ファイル名を.envに変更します。  
2. **.envファイルを編集**: .envファイルを開き、WinSCPの接続情報（ホスト名、ユーザー名、パスワード）と、X Developer Platformから取得した4種類のAPIキーを、プレースホルダーの部分にそれぞれ書き込んでください。このファイルは機密情報を含むため、Gitなどで公開しないでください。  
3. **config.jsonファイルを編集**: config.jsonを開き、あなたの環境に合わせて以下の項目を編集します。  
   * feed\_url: 各メディアのRSSフィードURL。  
   * winscp\_settings: WinSCPの実行ファイルパスと、サーバー上のアップロード先ディレクトリ。  
   * media\_templates内のx\_post\_template: Xへの投稿テンプレートやフィルタリングルール。

### **ステップ4: データベースの初期化**

ターミナルで以下のコマンドを実行し、コンテンツや投稿情報を保存するためのデータベースファイルを初めて作成します。この操作は最初の一度だけで大丈夫です。

python helhub.py init-db

## **使い方 (コマンド一覧)**

すべての操作は、helhub.pyを通じて行います。

### **helhub.py init-db**

データベースファイル (content.db) と、その中に必要なテーブルを初めて作成します。

### **helhub.py fetch**

config.jsonに設定されたRSSフィードを巡回します。新しいコンテンツが見つかると、データベースに保存し、設定されたフィルタリングルール（正規表現を含む）に基づいてX投稿の下書きを自動で作成します。

### **helhub.py generate-js**

データベースの最新情報をもとに、ウェブサイトが表示に使うデータファイル hel-data.js を生成・更新します。

### **helhub.py update-web**

ウェブサイトの更新とアップロードを全自動で行うための統合コマンドです。内部で fetch → generate-js を順に実行し、最後にWinSCPでサーバーにファイルをアップロードします。

### **helhub.py manage-posts**

Xへの投稿を管理するための対話型ツールを起動します。下書きの一覧表示、メッセージの編集、画像の添付、予約日時の設定、投稿の承認などが行えます。

### **helhub.py post-now**

データベースをチェックし、予約日時を過ぎた「承認済み」の投稿を、実際にXへ投稿します。

### **helhub.py generate-news**

メールマガジン用の原稿を生成します。config.jsonで設定された期間の最新コンテンツをまとめたMarkdownファイルが出力されます。

### **helhub.py hellog new**

ユーザー独自のカスタムコマンドを実行するためのサンプルです。（helhub.py内のパスを書き換えることで、ご自身のツールを組み込めます）